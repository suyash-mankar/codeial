<link rel="stylesheet" href="/css/home.css">

<div id="home-container">
        <section id="feed-posts">

                <h4>Posts</h4>
        
                <% if(locals.user){ %> 
        
                <form action="/posts/create" id="new-post-form" method="POST">
                        <textarea name="content" cols="30" rows="3" placeholder="Type Here..." required></textarea>
                        <input type="submit" value="Post">
                </form>
        
                <% } %> 
        
           
                <div id="posts-list-container">
                        <ul>
                                
                                <% for(let post of posts) { %> 
                                        <!-- sending context {post: post} to partial -->
                                        <%- include('_post', {post: post}) %>  
        
                                <% }%> 
                
                        </ul>
                </div>
        
               
              
        </section>


        <section id="users-friends">

                <div id="friends">
        
                        <h4>Friends</h4>

                        <% if(locals.user){ %> 

                                <!-- friendships array come from home_controller -->
                                <% for(let u of friendships) {%>
                                        <!-- if the logged in user received the friend request -->
                                        <% if(locals.user.id==u.to_user._id){ %>
                                                <p>
                                                        <!-- show the name of the person to who sent the request -->
                                                        <a href="/users/profile/<%=u.from_user._id%>">  <%= u.from_user.name %> </a>
                                                </p>
                                        <%}else{%>
                                        <!-- if the logged in user sent the friend request -->
                                                <p>
                                                        <!-- show the name of the person to whom request was sent -->
                                                        <a href="/users/profile/<%=u.to_user._id%>"> <%= u.to_user.name %> </a>
                                                </p>
                                        <%}%>
                        
                                <% } %> 

                        <% } %> 
                
                </div>

                <div id="users">
        
                        <h4>All Users</h4>
                        <% for(let u of all_users) {%>
                            
                                <p>
                                        <a href="/users/profile/<%=u.id%>"><%= u.name %> </a>
                                </p>
                
                        <% } %>
                
                </div>




        </section>
        
        <%- include('_chat_box'); %>        

</div>




<script src="/js/home_post_comments.js" ></script>
<script src="/js/home_posts.js"></script>
<script src="/js/toggle_likes.js"></script>

<!-- for already presend toggle-like-buttons -->
<script>

        $('.toggle-like-button').each(function(){
                let self = this;
                let toggleLike = new ToggleLike(self);
        });

</script>




        

